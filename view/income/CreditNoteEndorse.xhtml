<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a="http://richfaces.org/a4j"
                xmlns:rich="http://richfaces.org/rich" xmlns:g="http://gim.gob.ec/jsf"	
                template="../layout/template.xhtml">

    <ui:define name="body">

        <h:form id="endorse" styleClass="edit">

            <h:outputText styleClass="formTitle"
                          value="#{messages['common.endorseCreditNote']}" />
            <rich:panel>
               <f:facet name="header">#{messages['common.creditNoteDates']}</f:facet>
               <h:panelGrid>
               	<s:decorate id="creditNoteResolutionField" template="../layout/edit.xhtml">
							<ui:define name="label">#{messages['creditNote.resolutionNumber']}
							</ui:define>
							<h:inputText id="creditNoteResolution" size="30" readonly="true"
								value="#{creditNoteHome.creditNoteSelected.resolutionNumber}" />
				</s:decorate>
				<s:decorate id="creditNoteValueField" template="../layout/edit.xhtml">
							<ui:define name="label">#{messages['creditNote.value']}
							</ui:define>
							<h:inputText id="creditNoteValue" size="30" readonly="true"
								value="#{creditNoteHome.creditNoteSelected.value}" />
				</s:decorate>
				<s:decorate id="creditNoteDescriptionField" template="../layout/edit.xhtml">
							<ui:define name="label">#{messages['creditNote.description']}
							</ui:define>
							<h:inputTextarea id="creditNoteValue" readonly="true"
								value="#{creditNoteHome.creditNoteSelected.description}" />
				</s:decorate>
               </h:panelGrid>
            </rich:panel>
            <rich:panel>
                <f:facet name="header">#{messages['common.endorseDates']}</f:facet>
                <h:panelGrid columns="2" width="100%">
                    <h:panelGrid>
                        <f:facet name="header">
                            <h:outputText value="#{messages['common.residentEndorsePrevious']}" />
                        </f:facet>
                        <g:residentChooser id="residentChooser"
                                           resident="#{creditNoteHome.previousResident}"
                                           criteria="#{creditNoteHome.criteria}"
                                           bean="#{creditNoteHome}" searchAction="searchResidentPrevious"
                                           residentsList="#{creditNoteHome.residents}"
                                           identificationNumber="#{creditNoteHome.identificationNumberPrevious}"
                                           searchByCriteriaAction="searchByCriteria"
                                           clearSearchPanelAction="clearSearchPanel"
                                           residentChosenListenerName="previousResidentSelectedListener"
                                           required="true" disabled="true" />
                    </h:panelGrid>
                    <h:panelGrid>
                        <f:facet name="header">
                            <h:outputText value="#{messages['common.residentEndorseCurrent']}" />
                        </f:facet>
                        <g:residentChooser id="doneByChooser"
                                           resident="#{creditNoteHome.currentResident}"
                                           criteria="#{creditNoteHome.criteria}"
                                           bean="#{creditNoteHome}" searchAction="searchResidentCurrent"
                                           residentsList="#{creditNoteHome.residents}"
                                           identificationNumber="#{creditNoteHome.identificationNumberCurrent}"
                                           searchByCriteriaAction="searchByCriteria"
                                           clearSearchPanelAction="clearSearchPanel"
                                           residentChosenListenerName="currentSelectedListener"
                                           required="true" />
                    </h:panelGrid>
                </h:panelGrid>
				
				<s:decorate id="endoserUserField" template="../layout/edit.xhtml">
							<ui:define name="label">#{messages['common.endorseUser']}</ui:define>
							<h:inputText id="endorseUser" size="60" readonly="true"
								value="#{creditNoteHome.userSession.user.resident.name}" />
				</s:decorate>
				
                <s:decorate id="endorseDateField" template="../layout/edit.xhtml">
							<ui:define name="label">#{messages['common.endorseDate']}</ui:define>
							<h:inputText id="endorseDate" size="60" readonly="true"
								value="#{creditNoteHome.now.time}" >
								<f:convertDateTime
									pattern="#{messages['common.dateTimePattern']}" />
							</h:inputText>
				</s:decorate>

				<s:decorate id="endorseDetailField" template="../layout/edit.xhtml">
							<ui:define name="label">#{messages['common.reasonToEndorse']}</ui:define>
							<h:inputTextarea id="openDetail" required="true"
								value="#{creditNoteHome.endorseDetail}" />
				</s:decorate>

                <div style="clear: both">
                    <span class="required">*</span>
                    #{messages['common.requiredFields']}
                </div>

            </rich:panel>

            <div class="actionButtons">

                <h:commandButton id="save" value="#{messages['common.save']}"
					action="#{creditNoteHome.saveCreditNoteEndorse()}" />
								
                <s:button id="cancelEdit" value="#{messages['common.cancel']}"
					propagation="end" view="/income/CreditNoteList.xhtml" />

            </div>
        </h:form>

    </ui:define>

</ui:composition>
