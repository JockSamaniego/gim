<p:document xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://jboss.com/products/seam/pdf"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:c="http://java.sun.com/jstl/core"
    title="Convenio de Pago para Infracciones" subject="report" type="pdf" orientation="portrait"
    pageSize="A4" margins="30 20 20 20" author="Municipio de Loja"
    creator="Municipio de Loja">

    <f:facet name="header">
        <p:font size="9" name="HELVETICA" spacingAfter="15">
            <p:header borderWidthTop="0" borderWidthBottom="0" alignment="center">
                <p:paragraph>
                    <p:table columns="3" widthPercentage="100" spacingAfter="15"
                        widths="0.5 5 1">
                        <f:facet name="defaultCell">
                            <p:cell borderWidth="0" />
                        </f:facet>
                        <p:cell>
                            <p:image value="#{gim.institution.logo}" alignment="center" width="1" height="1">
                                <s:transformImageSize height="60" maintainRatio="true"/>
                            </p:image>
                        </p:cell>
                        <p:cell>
                            <p:font size="13" style="bold">
                                <p:paragraph alignment="center">#{gim.institution.name.toUpperCase()}</p:paragraph>
                            </p:font>
                            <p:font size="11" style="bold">
                                <p:paragraph alignment="center">Departamento de Coactivas y Recaudaciones</p:paragraph>
                            </p:font>
                            <p:font size="9" style="bold">
                                <p:paragraph alignment="center">Convenio de Pago por Infracciones de Tránsito</p:paragraph>
                            </p:font>
                        </p:cell>
                        <p:cell>
                            <p:font size="8" style="bold">
                                <p:paragraph alignment="center">#{messages['Convenio ID ']}</p:paragraph>
                                <p:paragraph alignment="center">#{infringementAgreementHome.instance.id}</p:paragraph>
                            </p:font>
                        </p:cell>
                    </p:table>
                </p:paragraph>
            </p:header>
            <p:footer borderWidthTop="0" 
                borderWidthBottom="0" alignment="center">
                 [<p:pageNumber />] - Convenio #{infringementAgreementHome.instance.id}
            </p:footer>
        </p:font>
    </f:facet>

    <p:font size="8" name="HELVETICA" >
        <p:table columns="2" widthPercentage="100">
            <f:facet name="defaultCell">
                <p:cell borderWidth="0" />
            </f:facet>
            <p:cell colspan="1" >
                <p:paragraph>
                    <p:font size="9" style="bold">
                        <p:text value="Impreso por: " />
                    </p:font>
                    <p:font size="9" >
                        <p:text value="#{userSession.user.resident.name}" />
                    </p:font>
                </p:paragraph>
            </p:cell>
            <p:cell colspan="1" >
                <p:paragraph>
                    <p:font size="9" style="bold">
                        <p:text value="Fecha de Impresión: " />
                    </p:font>
                    <p:font size="9" >
                        <p:text value="#{currentDatetime}">
                            <f:convertDateTime pattern="#{messages['common.dateFullTimePattern']}" />
                        </p:text>
                    </p:font>
                </p:paragraph>
            </p:cell>
        </p:table>
    </p:font>
    <p:font size="8" name="HELVETICA">
        <p:table columns="1" widthPercentage="100" headerRows="0" spacingBefore="15">
            <f:facet name="defaultCell">
                <p:cell borderWidth="0" />
            </f:facet>
            <p:cell colspan="1" horizontalAlignment="center" >
                <p:paragraph>
                    <p:font size="11" style="bold">
                        <p:text value="Detalle del Convenio" />
                    </p:font>
                </p:paragraph>
            </p:cell>
        </p:table>
        <p:table columns="4" widthPercentage="100" headerRows="0" widths="1 1 1 1">
            <f:facet name="defaultCell">
                <p:cell borderWidth="0" size="7" />
            </f:facet>
            <p:cell colspan="4">
                <p:paragraph />
                <p:paragraph spacingAfter="15" spacingBefore="5" alignment="justify" verticalAlignment="10" leading="25">
                    <p:font size="12">
                        <p:text
                            value="Se realizó un convenio de pago con el contribuyente " />
                    </p:font>
                    
                    <p:font size="13" style="bold">
                        <p:text
                            value=" #{infringementAgreementHome.instance.infractorName}," />
                    </p:font>
                    
                    <p:font size="12" >
                        <p:text
                            value=" con número de identificación: " />
                    </p:font>
                    
                    <p:font size="13" style="bold">
                        <p:text
                            value="#{infringementAgreementHome.instance.infractorIdentification}," />
                    </p:font>
                    
                    <p:font size="12">
                        <p:text
                            value=" con el siguiente detalle: " />
                    </p:font>           
                    <p:paragraph />
                </p:paragraph>
            </p:cell>
            
            <p:cell colspan="2">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:text value="Total Aproximado: $" />
                    </p:font>
                    <p:font size="8" >
                        <p:text value="#{infringementAgreementHome.instance.total}" />
                    </p:font>
                </p:paragraph>
            </p:cell>
            <p:cell colspan="2">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:text value="Cuotas: " />
                    </p:font>
                    <p:font size="8" >
                        <p:text value="#{infringementAgreementHome.instance.months}" />
                    </p:font>
                </p:paragraph>
            </p:cell>

            <p:cell colspan="2">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:text value="Porcentaje Inicial: " />
                    </p:font>
                    <p:font size="8" >
                        <p:text value="#{infringementAgreementHome.instance.percentage}%" />
                    </p:font>
                </p:paragraph>
            </p:cell>
            <p:cell colspan="2">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:text value="Cuota Inicial: $" />
                    </p:font>
                    <p:font size="8" >
                        <p:text value="#{infringementAgreementHome.instance.initialFee}" />
                    </p:font>
                </p:paragraph>
            </p:cell>
        </p:table>
        
        <p:table rendered="#{not empty infringementAgreementHome.instance.dividends}"
            columns="3" widthPercentage="70" headerRows="0" spacingBefore="15"
            widths="2 2 2">
            <p:font size="8" style="bold">
                <f:facet name="defaultCell">
                    <p:cell borderWidth="0" />
                </f:facet>
                <p:cell horizontalAlignment="center">
                    <p:paragraph>
                        <p:text value="#{messages['date']}" />
                    </p:paragraph>
                </p:cell>
                <p:cell horizontalAlignment="center">
                    <p:paragraph>
                        <p:text value="#{messages['dividend.balance']}" />
                    </p:paragraph>
                </p:cell>
                <p:cell horizontalAlignment="center">
                    <p:paragraph>
                        <p:text value="#{messages['dividend.amount']}" />
                    </p:paragraph>
                </p:cell>
            </p:font>
            
            <p:font size="7" >
                <ui:repeat value="#{infringementAgreementHome.instance.dividends}" var="_var">
                    <p:cell horizontalAlignment="center">
                        <p:paragraph alignment="center">
                            <p:text value="#{_var.date}">
                                <f:convertDateTime pattern="#{messages['common.datePattern']}" />
                            </p:text>
                        </p:paragraph>
                    </p:cell>
                    <p:cell horizontalAlignment="right">
                        <p:paragraph alignment="right">
                            <p:text value="#{_var.balance}" />
                        </p:paragraph>
                    </p:cell>

                    <p:cell horizontalAlignment="right">
                        <p:paragraph alignment="right">
                            <p:text value="#{_var.amount}" />
                        </p:paragraph>
                    </p:cell>

                </ui:repeat>
            </p:font>
        </p:table>
        
        <p:table columns="4" widthPercentage="100" headerRows="0" widths="1 1 1 1">
            <f:facet name="defaultCell">
                <p:cell borderWidth="0" size="7" />
            </f:facet>
            <p:cell colspan="4">
                <p:paragraph />
                <p:paragraph spacingAfter="15" spacingBefore="5" alignment="justify" >
                    <p:font size="10" style="bold">
                        <p:text
                            value="NOTA: " />
                    </p:font>
                    
                    <p:font size="10">
                        <p:text
                            value=" El Valor TOTAL del Convenio estará sujeto a cambios sin previo aviso, debido al cálculo de intereses y recargos." />
                    </p:font>
                    <p:paragraph />
                </p:paragraph>
            </p:cell>
        </p:table>
    </p:font>

    <p:font size="8" name="HELVETICA">
        <p:table columns="2" widthPercentage="100" headerRows="0" >
            <f:facet name="defaultCell">
                <p:cell borderWidth="0"/>
            </f:facet>
            <p:cell colspan="2" horizontalAlignment="center">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:paragraph />
                        <p:paragraph />
                        <p:paragraph />
                    </p:font>
                </p:paragraph>
            </p:cell>
            <p:cell colspan="2" horizontalAlignment="center">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:text value="FIRMAS DE AUTORIZACIÓN" />
                    </p:font>
                </p:paragraph>
            </p:cell>
        </p:table>
    </p:font>

    <p:font size="8" name="HELVETICA">
        <p:table columns="2" widthPercentage="100" headerRows="0" >
            <f:facet name="defaultCell">
                <p:cell borderWidth="0" />
            </f:facet>
            <p:cell colspan="1" horizontalAlignment="center">
                <p:paragraph>
                    <p:font size="8" style="bold" >
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:text value="#{infringementAgreementHome.instance.infractorName}" />
                        <p:paragraph/>
                        <p:text value="#{infringementAgreementHome.instance.infractorIdentification}" />
                    </p:font>
                </p:paragraph>
            </p:cell>
            <p:cell colspan="1" horizontalAlignment="center">
                <p:paragraph>
                    <p:font size="8" style="bold">
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:paragraph/>
                        <p:text value="#{infringementAgreementHome.instance.responsableName}" />
                        <p:paragraph/>
                        <p:text value="#{infringementAgreementHome.instance.responsableCharge}" />
                    </p:font>
                </p:paragraph>
            </p:cell>
        </p:table>
    </p:font>

</p:document>